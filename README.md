from https://github.com/esphome/esphome/pull/7290 by qfe0
